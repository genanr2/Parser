#include <afxtempl.h>
#include <afxcoll.h>
#include <io.h>
#include <SYS\STAT.H>
#include <stdio.h>
#include <direct.h>
#include <stdlib.h>
#include <string.h>
#include "calc.h"
#include <iostream>
//#include <iostream.h>
#include <fstream>
//#include <fstream.h>
#include <afx.h>
FILE*fileXls;
char*start[]={"D0","CF","11","E0","A1","B1","1A","E1","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","3e","00","03","00","fe","ff","09","00",
						"06","00","00","00","00","00","00","00","00","00","00","00","02","00","00","00",
						"01","00","00","00","00","00","00","00","00","10","00","00","86","00","00","00",
						"01","00","00","00","FE","ff","ff","ff","00","00","00","00","00","00","00","00",
						"72","00","00","00","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff","ff",
						"FD","ff","ff","ff","85","00","00","00","03","00","00","00","04","00","00","00",
						"05","00","00","00","06","00","00","00","07","00","00","00","08","00","00","00",
						"09","00","00","00","0a","00","00","00","0b","00","00","00","0c","00","00","00",
						"0d","00","00","00","0e","00","00","00","0f","00","00","00","10","00","00","00",
						"11","00","00","00","12","00","00","00","13","00","00","00","14","00","00","00",
						"15","00","00","00","16","00","00","00","17","00","00","00","18","00","00","00",
						"19","00","00","00","1a","00","00","00","1b","00","00","00","1c","00","00","00",
						"1d","00","00","00","1e","00","00","00","1f","00","00","00","20","00","00","00",
						"21","00","00","00","22","00","00","00","23","00","00","00","24","00","00","00",
						"25","00","00","00","26","00","00","00","27","00","00","00","28","00","00","00",
						"29","00","00","00","2A","00","00","00","2B","00","00","00","2C","00","00","00",
						"2D","00","00","00","2E","00","00","00","2F","00","00","00","30","00","00","00",
						"31","00","00","00","32","00","00","00","33","00","00","00","34","00","00","00",
						"35","00","00","00","36","00","00","00","37","00","00","00","38","00","00","00",
						"39","00","00","00","3A","00","00","00","3B","00","00","00","3C","00","00","00",
						"3D","00","00","00","3e","00","00","00","3F","00","00","00","40","00","00","00",
						"41","00","00","00","42","00","00","00","43","00","00","00","44","00","00","00",
						"45","00","00","00","46","00","00","00","47","00","00","00","48","00","00","00",
						"49","00","00","00","4A","00","00","00","4B","00","00","00","4C","00","00","00",
						"4D","00","00","00","4E","00","00","00","4F","00","00","00","50","00","00","00",
						"51","00","00","00","52","00","00","00","53","00","00","00","54","00","00","00",
						"55","00","00","00","56","00","00","00","57","00","00","00","58","00","00","00",
						"59","00","00","00","5A","00","00","00","5B","00","00","00","5C","00","00","00",
						"5D","00","00","00","5E","00","00","00","5F","00","00","00","60","00","00","00",
						"61","00","00","00","62","00","00","00","63","00","00","00","64","00","00","00",
						"65","00","00","00","66","00","00","00","67","00","00","00","68","00","00","00",
						"69","00","00","00","6A","00","00","00","6B","00","00","00","6C","00","00","00",
						"6D","00","00","00","6E","00","00","00","6F","00","00","00","70","00","00","00",
						"71","00","00","00","73","00","00","00","FD","ff","ff","ff","74","00","00","00",
						"75","00","00","00","76","00","00","00","77","00","00","00","78","00","00","00",
						"79","00","00","00","7A","00","00","00","7B","00","00","00","7C","00","00","00",
						"7D","00","00","00","7E","00","00","00","7F","00","00","00","80","00","00","00",
						"52","00","6F","00","6F","00","74","00","20","00","45","00","6E","00","74","00",
						"72","00","79","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"16","00","05","00","ff","ff","ff","ff","ff","ff","ff","ff","02","00","00","00",
						"20","08","02","00","00","00","00","00","C0","00","00","00","00","00","00","46",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","31","E6","CF",
						"36","30","BF","01","87","00","00","00","80","12","00","00","00","00","00","00",
						"57","00","6F","00","72","00","6B","00","62","00","6F","00","6F","00","6B","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"12","00","02","01","0b","00","00","00","ff","ff","ff","ff","ff","ff","ff","ff",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","02","00","00","00","C3","02","01","00","00","00","00","00",
						"5F","00","56","00","42","00","41","00","5F","00","50","00","52","00","4F","00",
						"4A","00","45","00","43","00","54","00","5F","00","43","00","55","00","52","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"22","00","01","01","01","00","00","00","09","00","00","00","08","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","60","6C","9B","CF","36","30","BF","01","00","31","E6","CF",
						"36","30","BF","01","00","00","00","00","00","00","00","00","00","00","00","00",
						"56","00","42","00","41","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"08","00","01","00","ff","ff","ff","ff","ff","ff","ff","ff","04","00","00","00",
						"00","00","00","00","00","00","00","00","00","00","00","00","00","00","00","00",
						"00","00","00","00","60","D6","B3","CF","36","30","BF","01","40","9F","C4","CF",
						"36","30","BF","01","00","00","00","00","00","00","00","00","00","00","00","00",0};
char*bof[]={"09",
						"08",
						"10","00",
						"00","06",	// Version number = 0600 for Biff8
						"05","00",	// Substream type = 0005 for WorkBook globals.
						"AF","18",	// Build identifier (= 0DBBh for MS Excel'97)
						"CD","07",	// Build year (= 07CCh for MS Excel'97)
						"41","40","00","00",	// File history flags	(bfn) 40 41
						"06","01","00","00",0	// Lowes Biff version. (sfo)
					};
char*interfaceHdr[]={"E1","00","02","00",
										 "B0","04", // Code page the file asved in
										 0
										};
//MMS: ADDMENU/DELMENU Record Group Count (C1h)
// This record stores the number of ADDMENU groups and DELMENU groups in the Book stream.
char*MMS[]={"C1","00","02","00","00","00",0};
//INTERFACEEND: End of User Interface Records (E2h)
//This record marks the end of the user interface section of the Book stream. It has no record data field.
char*INTERFACEEND[]={"E2","00","00","00",0};

//WRITEACCESS: Write Access User Name (5Ch)
//This record contains the user name, which is the name you type when you install Microsoft Excel.
char*writeAccess[]={"5C","00","70","00","04","00","01","13","04","35","04","3D",
										"04","30","04","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20","20","20","20","20","20","20","20","20",
										"20","20","20","20","20","20","20","20",0};

//CODEPAGE: Default Code Page (42h)
//The CODEPAGE record stores the default code page (character set) that was in use when the workbook was saved.
char*codePage[]={"42","00","02","00","B0","04",0};

char*unused1[]={"61","01","02","00","00","00",0};
char*Unknown1[]={"C0","01","00","00",0};

//TABID: Sheet Tab Index Array (13Dh)
//This record contains an array of sheet tab index numbers.The record is used by the Shared Lists feature.
//The sheet tab indexes have type short int (2 bytes each). The index numbers are 0-based and are assigned when
//a sheet is created; the sheets retain their index numbers throughout their lifetime in a workbook.
//If you rearrange the sheets in a workbook, the rgiTab array will change to reflect the new sheet arrangement.
//This record does not appear in BIFF5 files.
char*TABID[]={"3D","01","02","00","01","00",0};

//OBPROJ: Visual Basic Project (D3h)
//The contents of this record are reserved.
char*OBPROJ[]={"D3","00","00","00",0};

char*Unknown2[]={"BD","01","00","00",0};

//FNGROUPCOUNT: Built-in Function Group Count (9Ch)
//This record stores the number of built-in function groups (Financial, Math & Trig, Date & Time, and so on) 
//in the current version of Microsoft Excel.
//4	cFnGroup	2	Number of built-in function groups
char*FNGROUPCOUNT[]={"9C","00","02","00","0E","00",0};

//WINDOWPROTECT: Windows Are Protected (19h)
//The WINDOWPROTECT record stores an option from the Protect Workbook dialog box.
//4	fLockWn	2	= 1 if the workbook windows are protected
char*WINDOWPROTECT[]={"19","00","02","00","00","00",0};

//PROTECT: Protection Flag (12h)
//The PROTECT record stores the protection state for a sheet or workbook.
//4	fLock	2	= 1 if the sheet or workbook is protected
char*PROTECT[]={"12","00","02","00","00","00",0};

//PASSWORD: Protection Password (13h)
//The PASSWORD record contains the encrypted password for a protected sheet or workbook. 
//Note that this record specifies a sheet-level or workbook-level protection password, 
//as opposed to the FILEPASS record, which specifies a file password.
//4	wPassword	2	Encrypted password
char*PASSWORD[]={"13","00","02","00","00","00",0};
//PROT4REV: Shared Workbook Protection Flag (1AFh)
//The PROT4REV record stores a shared-workbook protection flag.
//4	fRevLock	2	= 1 if the Sharing with Track Changes option is on (Protect Shared Workbook dialog box)
char*Unknown3[]={"AF","01","02","00","00","00",0};
//PROT4REVPASS: Shared Workbook Protection Password (1BCh)
//The PROT4REV record stores an encrypted password for shared-workbook protection.
//4	wRevPass	2	Encrypted password (if this field is 0 (zero), there is no Shared Workbook Protection Password; 
//the password is entered in the Protect Shared Workbook dialog box)
char*Unknown4[]={"BC","01","02","00","00","00",0};
/*
00DAA: [WINDOW1] (3Dh  61dec)
WINDOW1: Window Information (3Dh)
The WINDOW1 record contains workbook-level window attributes. 
The xWn and yWn fields contain the location of the window in units of 1/20 of a point, relative to the 
upper-left corner of the Microsoft Excel window client area. The dxWn and dyWn fields contain the window size, 
also in units of 1/20 of a point.
						Record Data
Offset	 Name	 			Size	 Contents
4				 xWn	 			2		 Horizontal position of the window
6				 yWn	 			2		 Vertical position of the window
8				 dxWn	 			2		 Width of the window
10			 dyWn	 			2		 Height of the window
12			 grbit 			2		 Option flags
14			 itabCur  	2		 Index of selected workbook tab (0-based)
16			 itabFirst  2		 Index of first displayed workbook tab (0-based)
18			 ctabSel	  2		 Number of workbook tabs that are selected
20			 wTabRatio  2		 Ratio of width of the workbook tabs to the width of the horizontal scroll bar; 
												 to obtain the ratio, convert to decimal and then divide by 1000.
The grbit field contains the following option flags.
Offset	 Bits	 Mask	 Name		 				Contents
0				 0		 01h	 fHidden	 			= 1 if the window is hidden
				 1		 02h	 fIconic	 			= 1 if the window is currently displayed 
																			as an icon
				 2		 04h	 (reserved)
				 3		 08h	 fDspHScroll 		= 1 if horizontal scroll bar is displayed
				 4		 10h	 fDspVScroll 		= 1 if vertical scroll bar is displayed
				 5		 20h	 fBotAdornment 	= 1 if workbook tabs are displayed
				 7-6	 C0h	 (reserved)
1				 7-0	 FFh	 (reserved)
*/
char*Window1[]={"3D","00","12","00","E0","01","0F","00","8C","37","83","22","38","00",
							  "00","00","00","00","01","00","58","02",0};

char*backup[]={"40","00","02","00","00","00",0};
char*hideObj[]={"8D","00","02","00","00","00",0};
char*c1904[]={"22","00","02","00","00","00",0};
char*precision[]={"0E","00","02","00","01","00",0};
//REFRESHALL: Refresh Flag (1B7h)
//This record stores an option flag.
//4	fRefreshAll	2	= 1 then Refresh All should be done on all external data ranges and PivotTables when 
//loading the workbook (the default is = 0)
char*Unknown5[]={"B7","01","02","00","00","00",0};
char*bookBool[]={"DA","00","02","00","00","00",0};
char*font1[]={"31","00","22","00","C8","00","00","00","FF","7F","90","01",
							"00","00","00","00","CC","00","09","01","41","00","72","00","69","00","61","00",
							"6C","00","20","00","43","00","79","00","72","00",0};
char*font2[]={"31","00","22","00","C8","00","00","00","FF","7F","90","01","00","00","00","00","CC","00","09","01","41","00",
							"72","00","69","00","61","00","6C","00","20","00","43","00","79","00","72","00",0};
char*font3[]={"31","00","22","00","C8","00","00","00","FF","7F","90","01","00","00","00","00",
							"CC","00","09","01","41","00","72","00","69","00","61","00","6C","00","20","00",
							"43","00","79","00","72","00",0};
char*font4[]={"31","00","22","00","C8","00","00","00","FF","7F",
							"90","01","00","00","00","00","CC","00","09","01","41","00","72","00","69","00",
							"61","00","6C","00","20","00","43","00","79","00","72","00",0};
char*font5[]={"31","00","22","00",
							"C8","00","01","00","FF","7F","BC","02","00","00","00","02","CC","00","09","01",
							"41","00","72","00","69","00","61","00","6C","00","20","00","43","00","79","00","72","00",0};
char*font6[]={"31","00","22","00","C8","00","00","00","FF","7F","90","01","00","00"
							"00","02","CC","00","09","01","41","00","72","00","69","00","61","00","6C","00",
							"20","00","43","00","79","00","72","00",0};
char*font7[]={"31","00","22","00","C8","00","01","00",
							"0A","00","BC","02","00","00","00","02","CC","00","09","01","41","00","72","00",
							"69","00","61","00","6C","00","20","00","43","00","79","00","72","00",0};
char*font8[]={"31","00",
							"1C","00","A0","00","01","00","51","00","BC","02","00","00","00","00","CC","00",
							"06","01","54","00","61","00","68","00","6F","00","6D","00","61","00",0};
char*font9[]={"31","00",
							"1C","00","A0","00","00","00","51","00","90","01","00","00","00","00","CC","00",
							"06","01","54","00","61","00","68","00","6F","00","6D","00","61","00",0};
//FORMAT: Number Format (41Eh)
//The FORMAT record describes a number format in the workbook.
//All the FORMAT records should appear together in a BIFF file. 
//The order of FORMAT records in an existing BIFF file should not be changed. 
//You can write custom number formats in a file, but they should be added at the end of the existing 
//FORMAT records.
char*format1[]={"1E","04",
								"2F","00","05","00","15","00","01","23","00","2C","00","23","00","23","00","30",
								"00","22","00","40","04","2E","00","22","00","3B","00","5C","00","2D","00","23",
								"00","2C","00","23","00","23","00","30","00","22","00","40","04","2E","00","22","00",0};
char*format2[]={"1E","04","39","00","06","00","1A","00","01","23","00","2C","00","23","00",
								"23","00","30","00","22","00","40","04","2E","00","22","00","3B","00","5B","00",
								"52","00","65","00","64","00","5D","00","5C","00","2D","00","23","00","2C","00",
								"23","00","23","00","30","00","22","00","40","04","2E","00","22","00",0};

char*format3[]={"1E","04",
								"3B","00","07","00","1B","00","01","23","00","2C","00","23","00","23","00","30",
								"00","2E","00","30","00","30","00","22","00","40","04","2E","00","22","00","3B",
								"00","5C","00","2D","00","23","00","2C","00","23","00","23","00","30","00","2E",
								"00","30","00","30","00","22","00","40","04","2E","00","22","00",0};

char*format4[]={"1E","04","45",
								"00","08","00","20","00","01","23","00","2C","00","23","00","23","00","30","00",
								"2E","00","30","00","30","00","22","00","40","04","2E","00","22","00","3B","00",
								"5B","00","52","00","65","00","64","00","5D","00","5C","00","2D","00","23","00",
								"2C","00","23","00","23","00","30","00","2E","00","30","00","30","00","22","00",
								"40","04","2E","00","22","00",0};

char*format5[]={"1E","04","6B","00","2A","00","33","00","01","5F",
								"00","2D","00","2A","00","20","00","23","00","2C","00","23","00","23","00","30",
								"00","22","00","40","04","2E","00","22","00","5F","00","2D","00","3B","00","5C",
								"00","2D","00","2A","00","20","00","23","00","2C","00","23","00","23","00","30",
								"00","22","00","40","04","2E","00","22","00","5F","00","2D","00","3B","00","5F",
								"00","2D","00","2A","00","20","00","22","00","2D","00","22","00","22","00","40",
								"04","2E","00","22","00","5F","00","2D","00","3B","00","5F","00","2D","00","40",
								"00","5F","00","2D","00",0};

char*format6[]={"1E","04","6B","00","29","00","33","00","01","5F","00",
								"2D","00","2A","00","20","00","23","00","2C","00","23","00","23","00","30","00",
								"5F","00","40","04","5F","00","2E","00","5F","00","2D","00","3B","00","5C","00",
								"2D","00","2A","00","20","00","23","00","2C","00","23","00","23","00","30","00",
								"5F","00","40","04","5F","00","2E","00","5F","00","2D","00","3B","00","5F","00",
								"2D","00","2A","00","20","00","22","00","2D","00","22","00","5F","00","40","04",
								"5F","00","2E","00","5F","00","2D","00","3B","00","5F","00","2D","00","40","00",
								"5F","00","2D","00",0};

char*format7[]={"1E","04","7B","00","2C","00","3B","00","01","5F","00","2D",
								"00","2A","00","20","00","23","00","2C","00","23","00","23","00","30","00","2E",
								"00","30","00","30","00","22","00","40","04","2E","00","22","00","5F","00","2D",
								"00","3B","00","5C","00","2D","00","2A","00","20","00","23","00","2C","00","23",
								"00","23","00","30","00","2E","00","30","00","30","00","22","00","40","04","2E",
								"00","22","00","5F","00","2D","00","3B","00","5F","00","2D","00","2A","00","20",
								"00","22","00","2D","00","22","00","3F","00","3F","00","22","00","40","04","2E",
								"00","22","00","5F","00","2D","00","3B","00","5F","00","2D","00","40","00","5F",
								"00","2D","00",0};

char*format8[]={"1E","04","7B","00","2B","00","3B","00","01","5F","00","2D","00",
								"2A","00","20","00","23","00","2C","00","23","00","23","00","30","00","2E","00",
								"30","00","30","00","5F","00","40","04","5F","00","2E","00","5F","00","2D","00",
								"3B","00","5C","00","2D","00","2A","00","20","00","23","00","2C","00","23","00",
								"23","00","30","00","2E","00","30","00","30","00","5F","00","40","04","5F","00",
								"2E","00","5F","00","2D","00","3B","00","5F","00","2D","00","2A","00","20","00",
								"22","00","2D","00","22","00","3F","00","3F","00","5F","00","40","04","5F","00",
								"2E","00","5F","00","2D","00","3B","00","5F","00","2D","00","40","00","5F","00",
								"2D","00",0};

char*format9[]={"1E","04","08","00","A4","00","03","00","00","30","2E","30",0};




//XF: Extended Format (E0h)
//The XF record stores formatting properties. There are two different XF records, one for cell records and 
//another for style records. The fStyle bit is true if the XF is a style XF. The ixfe of a cell record (BLANK, 
//LABEL, NUMBER, RK, and so on) points to a cell XF record, and the ixfe of a STYLE record points to a style 
//XF record. Note that in previous BIFF versions, the record number for the XF record was 43h.

//Prior to BIFF5, all number format information was included in FORMAT records in the BIFF file. 
//Beginning with BIFF5, many of the built-in number formats were moved to an internal table and are no longer 
//saved with the file as FORMAT records. You still use the ifmt to associate the built-in number formats with 
//an XF record. However, the internal number formats are no longer visible in the BIFF file.
//The following table lists all the number formats that are now maintained internally. Note that 17h through 
//24h are reserved for international versions and are undocumented at this time.
char*xf1[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","00","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf2[]={"E0","00","14","00","01","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf3[]={"E0","00",
						"14","00","01","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf4[]={"E0","00","14","00","02","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf5[]={"E0","00",
						"14","00","02","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf6[]={"E0","00","14","00","00","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0}; // 12.01.2007
char*xf7[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf8[]={"E0","00","14","00","00","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf9[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf10[]={"E0","00","14","00","00","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf11[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf12[]={"E0","00","14","00","00","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf13[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf14[]={"E0","00","14","00","00","00","00","00","F5","FF",
						"20","00","00","F4","00","00","00","00","00","00","00","00","C0","20",0};
char*xf15[]={"E0","00",
						"14","00","00","00","00","00","F5","FF","20","00","00","F4","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf16[]={"E0","00","14","00","00","00","00","00","01","00",
						"20","00","00","00","00","00","00","00","00","00","00","00","C0","20",0};
char*xf17[]={"E0","00",
						"14","00","01","00","2C","00","F5","FF","20","00","00","F8","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf18[]={"E0","00","14","00","01","00","2A","00","F5","FF",
						"20","00","00","F8","00","00","00","00","00","00","00","00","C0","20",0};
char*xf19[]={"E0","00",
						"14","00","01","00","09","00","F5","FF","20","00","00","F8","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf20[]={"E0","00","14","00","01","00","2B","00","F5","FF",
						"20","00","00","F8","00","00","00","00","00","00","00","00","C0","20",0};
char*xf21[]={"E0","00",
						"14","00","01","00","29","00","F5","FF","20","00","00","F8","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf22[]={"E0","00","14","00","05","00","00","00","00","00",
						"20","00","00","88","00","00","00","00","00","00","00","00","C0","20",0};
char*xf23[]={"E0","00",
						"14","00","06","00","00","00","00","00","20","00","00","88","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf24[]={"E0","00","14","00","06","00","A4","00","00","00",
						"20","00","00","8C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf25[]={"E0","00",
						"14","00","06","00","A4","00","01","00","20","00","00","0C","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf26[]={"E0","00","14","00","06","00","00","00","01","00",
						"20","00","00","08","00","00","00","00","00","00","00","00","C0","20",0};
char*xf27[]={"E0","00",
						"14","00","06","00","00","00","01","00","20","00","00","2C","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf28[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","8C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf29[]={"E0","00",
						"14","00","06","00","00","00","00","00","20","00","00","AC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf30[]={"E0","00","14","00","06","00","00","00","00","00",
						"20","00","00","A8","22","22","40","20","40","20","00","00","C0","20",0};
char*xf31[]={"E0","00",
						"14","00","05","00","00","00","00","00","20","00","00","A8","55","05","40","20",
						"40","00","00","00","C0","20",0};
char*xf32[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","05","05","40","00","40","00","00","00","C0","20",0};
char*xf33[]={"E0","00",
						"14","00","05","00","A4","00","00","00","20","00","00","AC","55","05","40","20",
						"40","00","00","00","C0","20",0};
char*xf34[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf35[]={"E0","00",
						"14","00","06","00","A4","00","00","00","20","00","00","AC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf36[]={"E0","00","14","00","06","00","A4","00","01","00",
						"20","00","00","2C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf37[]={"E0","00",
						"14","00","05","00","00","00","00","00","20","00","00","A8","55","00","40","20",
						"00","00","00","00","C0","20",0};
char*xf38[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","05","00","40","00","00","00","00","00","C0","20",0};
char*xf39[]={"E0","00",
						"14","00","05","00","A4","00","00","00","20","00","00","AC","55","00","40","20",
						"00","00","00","00","C0","20",0};
char*xf40[]={"E0","00","14","00","05","00","00","00","00","00",
						"20","00","00","A8","05","00","40","00","00","00","00","00","C0","20",0};
char*xf41[]={"E0","00",
						"14","00","05","00","00","00","00","00","20","00","00","A8","55","50","40","20",
						"00","20","00","00","C0","20",0};
char*xf42[]={"E0","00","14","00","05","00","00","00","00","00",
						"20","00","00","A8","00","50","00","00","00","20","00","00","C0","20",0};
char*xf43[]={"E0","00",
						"14","00","05","00","A4","00","00","00","20","00","00","AC","55","50","40","20",
						"00","20","00","00","C0","20",0};
char*xf44[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","50","50","00","20","00","20","00","00","C0","20",0};
char*xf45[]={"E0","00",
						"14","00","06","00","00","00","00","00","20","00","00","A8","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf46[]={"E0","00","14","00","06","00","31","00","00","00",
						"22","00","00","BC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf47[]={"E0","00",
						"14","00","06","00","01","00","00","00","20","00","00","AC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf48[]={"E0","00","14","00","06","00","00","00","00","00",
						"28","00","00","B8","00","00","00","00","00","00","00","00","C0","20",0};
char*xf49[]={"E0","00",
						"14","00","05","00","00","00","00","00","20","00","00","A8","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf50[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","05","55","40","00","40","20","00","00","C0","20",0};
char*xf51[]={"E0","00",
						"14","00","05","00","A4","00","00","00","20","00","00","AC","00","55","00","00",
						"40","20","00","00","C0","20",0};
char*xf52[]={"E0","00","14","00","05","00","A4","00","00","00",
						"20","00","00","AC","50","55","00","20","40","20","00","00","C0","20",0};
char*xf53[]={"E0","00",
						"14","00","05","00","00","00","00","00","22","00","00","BC","55","55","40","20",
						"40","20","00","00","C0","20",0};
char*xf54[]={"E0","00","14","00","05","00","31","00","00","00",
						"20","00","00","AC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf55[]={"E0","00",
						"14","00","05","00","00","00","01","00","22","00","00","38","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf56[]={"E0","00","14","00","06","00","00","00","00","00",
						"28","00","00","98","00","00","00","00","00","00","00","00","C0","20",0};
char*xf57[]={"E0","00",
						"14","00","06","00","31","00","00","00","22","00","00","9C","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf58[]={"E0","00","14","00","06","00","01","00","00","00",
						"23","00","00","9C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf59[]={"E0","00",
						"14","00","06","00","00","00","00","00","23","00","00","BC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf60[]={"E0","00","14","00","06","00","A4","00","01","00",
						"23","00","00","9C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf61[]={"E0","00",
						"14","00","06","00","A4","00","00","00","23","00","00","BC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf62[]={"E0","00","14","00","06","00","A4","00","00","00",
						"23","00","00","9C","00","00","00","00","00","00","00","00","C0","20",0};
char*xf63[]={"E0","00",
						"14","00","06","00","00","00","01","00","20","00","00","7C","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf64[]={"E0","00","14","00","06","00","00","00","00","00",
						"28","00","00","BC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf65[]={"E0","00",
						"14","00","06","00","01","00","00","00","23","00","00","BC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf66[]={"E0","00","14","00","05","00","00","00","00","00",
						"20","00","00","AC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf67[]={"E0","00",
						"14","00","06","00","00","00","00","00","20","00","00","FC","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf68[]={"E0","00","14","00","07","00","00","00","00","00",
						"23","00","00","BC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf69[]={"E0","00",
						"14","00","06","00","00","00","01","00","20","00","00","28","00","00","00","00",
						"00","00","00","00","C0","20",0};
char*xf70[]={"E0","00","14","00","05","00","00","00","00","00",
						"22","00","00","BC","00","00","00","00","00","00","00","00","C0","20",0};
char*xf71[]={"E0","00",
						"14","00","06","00","31","00","00","00","21","00","00","BC","00","00","00","00",
						"00","00","00","00","C0","20",0};

//01886:","[XF]","(E0h","","224dec)
//0189E:","[XF]","(E0h","","224dec)
//018B6:","[XF]","(E0h","","224dec)
char*xf72[]={"E0","00","14","00","06","00","00","00","00","00",
						"21","00","00","BC","00","00","00","00","00","00","00","00","C0","20",0};
char*style1[]={"93","02","04","00","10","80","04","FF",0};
char*style2[]={"93","02","04","00","11","80","07","FF",0};
char*style3[]={"93","02","04","00","00","80","00","FF",0};
char*style4[]={"93","02","04","00","12","80","05","FF",0};
char*style5[]={"93","02","04","00","13","80","03","FF",0};
char*style6[]={"93","02","04","00","14","80","06","FF",0};

char*unused2[]={"60","01","02","00","00","00",0};

//BOUNDSHEET: Sheet Information (85h)
//This record stores the sheet name, sheet type, and stream position.
//01904: [BUNDLESHEET] (85h  133dec)
char*boundSheet[]={"85","00","12","00","39","37","00","00","00","00","05","01",
									"1B","04","38","04","41","04","42","04","31","00",0};
//0191A:","[COUNTRY]","(8Ch","","140dec)
char*country[]={"8C","00","04","00","07","00","07","00",0};
char*Unknown6[]={"AE","01","04","00","01","00","01","04",0};
//0192A:","[EXTERNSHEET]","(17h","","23dec)
char*externSheet[]={"17","00","08","00","01","00","00","00","00","00","00","00",0};
char*Unknown7[]={"c1","01","08","00","c1","01","00","00","60","69","01","00",0};
char*unused3[]={"eb","00","5a","00","0f","00","00","f0","52","00","00","00","00","00","06","f0",
								"18","00","00","00","25","04","00","00","02","00","00","00","25","00","00","00",
								"01","00","00","00","01","00","00","00","25","00","00","00","33","00","0b","f0",
								"12","00","00","00","bf","00","08","00","08","00","81","01","09","00","00","08",
								"c0","01","40","00","00","08","40","00","1e","f1","10","00","00","00","0d","00",
								"00","08","0c","00","00","08","17","00","00","08","f7","00","00","10",0};

using namespace std;

class Index
{
public:
	long rwMic;//xloper Excel4
	long rwMac;
	long*rgibRw;
//	CList<long&,long> rgibRw;
	CList<int,int> rgibRw2;
};
class DbCell
{
	long dbRtrw;
	long rgdb; // CArray
};
LONG MyAtol(LPTSTR szString,BOOL bHex,LPBOOL bSuccess);
void writeXls()
{
//	char fileName[128];
//	ofstream ifs((LPCTSTR)*fileName);//}
//	CList ccl;
//	ccl.
//	CList<CString, CString&> myList2;
//	myList2.
//	CList<int, int> rgibRw2;
//	rgibRw2.

	Index ind;
	ind.rgibRw2.AddTail(100);


//	ind.rgibRw.


	CDWordArray arr;
	ofstream ifs("all2.xls",ios::trunc|ios::binary);//}
	try
	{
		int i=0;
		char**str1=start;
		long dig=5;
		LPBOOL success;
		while(*str1!=NULL)
		{
			dig=MyAtol(start[i],true,success);if(*success)ifs<<(TCHAR)dig;i++;str1++;
		}
		str1=bof;
		i=0;
		while(*str1!=NULL)
		{
			dig=MyAtol(bof[i],true,success);if(*success)ifs<<(TCHAR)dig;i++;str1++;
		}
  }catch(char*ss){MessageBox(NULL,ss,"Программа записи.",MB_OK);}
	ifs.close();
}
int HexDigitToInt(IN char c)
{     
	if(c>='0'&&c<='9'){return(c-'0');}
	if(tolower(c)>='a'&&tolower(c)<='f'){return(tolower(c)-'a'+10);}return-1;
}    
LONG MyAtol(LPTSTR szString,BOOL bHex,LPBOOL bSuccess)
{   
	LPTSTR p;LONG l;LONG lMultiplier;BOOL bDigit;
	if(bHex)lMultiplier=16;//else lMultiplier=10;
	p=szString;l=0;
	while(*p)//while chars
	{
		bDigit=FALSE;//set to false for each char that we look at
		if(*p>=(TCHAR)'0'&&*p<=(TCHAR)'9')//is it an ascii char ?
			{bDigit=TRUE;l+=(*p-(TCHAR)'0');}
		if(bHex)
		{	//or hex?
			if(*p>=(TCHAR)'A'&&*p<=(TCHAR)'F'){l+=(*p-(TCHAR)'A'+10);bDigit=TRUE;}
			if(*p>=(TCHAR)'a'&&*p<=(TCHAR)'f'){l+=(*p-(TCHAR)'a'+10);bDigit=TRUE;}
		}if(bDigit==FALSE){*bSuccess=FALSE;return 0;}
		p++;//get next char
		if(*p)//if there is going to be at least one more char
			l*=lMultiplier;//then multiply what we have by the multiplier...
	}*bSuccess=TRUE;
	return l;//success! return the value.
}
